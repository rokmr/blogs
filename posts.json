---
layout: null
---
[
{% assign all_items = "" | split: "" %}
{% for post in site.posts %}
  {% assign all_items = all_items | push: post %}
{% endfor %}
{% for note in site.notes %}
  {% unless note.url contains '/index' or note.layout == 'subject' or note.layout == 'sub-subject' %}
  {% if note.content and note.content != empty %}
    {% assign all_items = all_items | push: note %}
  {% endif %}
  {% endunless %}
  {% endfor %}
{% for item in all_items %}
{
  "title": {{ item.title | jsonify }},
  "url": "{{ item.url | relative_url }}",
  "date": "{{ item.date | date: '%Y-%m-%d' }}",
  "excerpt": {{ item.description | default: item.excerpt | strip_html | replace: '$$', '' | replace: '$', '' | truncate: 200 | jsonify }},
  "tags": {{ item.tags | jsonify }},
  "type": "{% if item.collection == 'posts' %}post{% else %}note{% endif %}",
  "links": [
    {% assign content_links = item.content | split: 'href="' %}
    {% for link in content_links offset: 1 %}
      {% assign url = link | split: '"' | first %}
      {% if url contains '/blogs/' or url contains '[[' %}
        {{ url | jsonify }}{% unless forloop.last %},{% endunless %}
      {% endif %}
    {% endfor %}
  ],
  "content_snippet": {{ item.content | strip_html | truncate: 500 | jsonify }}
}{% unless forloop.last %},{% endunless %}
{% endfor %}
]
